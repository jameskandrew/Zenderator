<?php
namespace {{ app_namespace }}\SDK\{{ app_name }};

use Gone\SDK\Common\Abstracts\AbstractClient;

class Client extends AbstractClient
{
    const DEFAULT_BASE_URL = "{{ default_base_url }}";
{#
{% for pack in packs|keys %}
    /** @var AccessLayer\{{ pack }}AccessLayer */
    public ${{ pack|transform_studly_to_camel }};

{% endfor %}
#}
    public function __construct($baseUrl = self::DEFAULT_BASE_URL, $extraHeaders = []){
        parent::__construct($baseUrl,$extraHeaders);
{#
{% for pack in packs|keys %}
        $this->{{ pack|transform_studly_to_camel }} = new AccessLayer\{{ pack }}AccessLayer($this);
{% endfor %}
#}
    }

    public static function DependencyInjector($container,$config) {

        $container[\{{ app_namespace }}\SDK\{{ app_name }}\Client::class] = function($container) use ($config) {
            $client = new self($config["baseUrl"] ?? self::DEFAULT_BASE_URL,$config["extraHeaders"] ?? []);
            return $client;
        };

{% for pack in packs|keys %}
        $container[\{{ app_namespace }}\SDK\{{ app_name }}\AccessLayer\{{ pack }}AccessLayer::class] = function($container) {
            return new AccessLayer\{{ pack }}AccessLayer($container->get(\{{ app_namespace }}\SDK\{{ app_name }}\Client::class)->getGuzzle());
        };
{% endfor %}
    }
}
